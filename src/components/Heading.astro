---
interface Props {
  id?: string;
  location?: string;
  href?: string;
  subtext?: string;
  class?: string;
}

const { id, location, href, subtext, class: className } = Astro.props;

// Get the slot content for auto-generating ID if not provided
const slotContent = await Astro.slots.render('default');
const textContent = slotContent.replace(/<[^>]*>/g, '').trim();
const slug = id || textContent.toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/(^-|-$)/g, '');
---

<div id={slug} class:list={["!mt-12 !mb-4 flex items-start gap-3 group scroll-mt-8", className]}>
  <div class="flex-shrink-0 mt-1">
    <svg
      xmlns="http://www.w3.org/2000/svg"
      viewBox="0 0 24 24"
      fill="currentColor"
      class="w-5 h-5 text-terracotta"
    >
      <path fill-rule="evenodd" d="M11.54 22.351l.07.04.028.016a.76.76 0 00.723 0l.028-.015.071-.041a16.975 16.975 0 001.144-.742 19.58 19.58 0 002.683-2.282c1.944-1.99 3.963-4.98 3.963-8.827a8.25 8.25 0 00-16.5 0c0 3.846 2.02 6.837 3.963 8.827a19.58 19.58 0 002.682 2.282 16.975 16.975 0 001.145.742zM12 13.5a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd" />
    </svg>
  </div>
  <div class="flex flex-col gap-0.5">
    <h2 class="text-xl font-medium text-stone-800 tracking-tight leading-tight">
      <a href={`#${slug}`} class="hover:text-terracotta transition-colors">
        <span set:html={slotContent} />
        <span class="opacity-0 group-hover:opacity-100 transition-opacity text-stone-300 ml-2 text-base font-normal">#</span>
      </a>
    </h2>
    {location && (
      href ? (
        <a
          href={href}
          target="_blank"
          rel="noopener noreferrer"
          class="text-xs text-stone-400 hover:text-terracotta transition-colors flex items-center gap-1"
        >
          <span>{location}</span>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="w-3 h-3 opacity-50">
            <path d="M6.22 8.72a.75.75 0 0 0 1.06 1.06l5.22-5.22v1.69a.75.75 0 0 0 1.5 0v-3.5a.75.75 0 0 0-.75-.75h-3.5a.75.75 0 0 0 0 1.5h1.69L6.22 8.72Z" />
            <path d="M3.5 6.75c0-.69.56-1.25 1.25-1.25H7A.75.75 0 0 0 7 4H4.75A2.75 2.75 0 0 0 2 6.75v4.5A2.75 2.75 0 0 0 4.75 14h4.5A2.75 2.75 0 0 0 12 11.25V9a.75.75 0 0 0-1.5 0v2.25c0 .69-.56 1.25-1.25 1.25h-4.5c-.69 0-1.25-.56-1.25-1.25v-4.5Z" />
          </svg>
        </a>
      ) : (
        <span class="text-xs text-stone-400">{location}</span>
      )
    )}
    {subtext && (
      <p class="text-sm text-stone-500 mt-1.5 leading-relaxed max-w-prose">{subtext}</p>
    )}
  </div>
</div>
